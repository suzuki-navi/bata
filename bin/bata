#!/bin/bash

set -Ceu

dir=$(cd $(dirname $(realpath $0)); cd ..; pwd)

if [ $(docker images -q bata | wc -l) = 0 ]; then
    (
        cd $dir
        docker build -t bata .
    )
fi

if [ -t 1 ]; then
    docker run -it --rm -v $dir:/usr/source -v $HOME/.aws:/root/.aws bata python3 /usr/source/src/main.py "$@"
else
    docker run --rm -v $dir:/usr/source -v $HOME/.aws:/root/.aws bata python3 /usr/source/src/main.py "$@"
fi

